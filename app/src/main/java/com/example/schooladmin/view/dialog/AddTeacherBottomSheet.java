package com.example.schooladmin.view.dialog;import android.app.ProgressDialog;import android.content.BroadcastReceiver;import android.content.Context;import android.content.Intent;import android.content.IntentFilter;import android.os.Bundle;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.Button;import android.widget.EditText;import android.widget.Spinner;import android.widget.Toast;import androidx.annotation.NonNull;import androidx.annotation.Nullable;import androidx.fragment.app.DialogFragment;import com.example.schooladmin.R;import com.example.schooladmin.connectdb.ConnectDB;import com.example.schooladmin.model.Student;import com.example.schooladmin.model.Subject;import com.example.schooladmin.model.Teacher;import com.example.schooladmin.query.TeacherQuery;import com.example.schooladmin.view.adapter.SubjectSpinnerAdapter;import com.google.android.material.bottomsheet.BottomSheetDialogFragment;import java.util.ArrayList;import java.util.List;public class AddTeacherBottomSheet extends BottomSheetDialogFragment {    private Spinner spinnerBootomSheetAddTeacherSubjectName;    private List<Subject> subjects;    private SubjectSpinnerAdapter subjectSpinnerAdapter;    private EditText edtBottomSheetAddTeacherName;    private EditText edtBottomSheetAddTeacherPassword;    private Button btnBottomSheetAddTeacherSave;    private ProgressDialog progressDialog;    private TeacherQuery teacherQuery;    private ConnectDB connectDB;    @Override    public void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate( savedInstanceState );        setStyle( DialogFragment.STYLE_NORMAL, R.style.DialogStyle );    }    @Nullable    @Override    public View onCreateView(@NonNull LayoutInflater inflater,                             @Nullable ViewGroup container,                             @Nullable Bundle savedInstanceState) {        View view = inflater.inflate( R.layout.bottom_sheet_add_teacher, container );        connectDB = new ConnectDB();        teacherQuery = new TeacherQuery( getContext() );        progressDialog = new ProgressDialog( getContext() );        edtBottomSheetAddTeacherName = view.findViewById( R.id.edtBottomSheetAddTeacherName );        edtBottomSheetAddTeacherPassword = view.findViewById( R.id.edtBottomSheetAddTeacherPassword );        btnBottomSheetAddTeacherSave = view.findViewById( R.id.btnBottomSheetAddTeacherSave );        spinnerBootomSheetAddTeacherSubjectName = view.findViewById( R.id.spinnerBootomSheetAddTeacherSubjectName );        subjects = new ArrayList<>();        teacherQuery.callTaskGetAllSubject();        subjectSpinnerAdapter = new SubjectSpinnerAdapter( getContext(), subjects );        spinnerBootomSheetAddTeacherSubjectName.setAdapter( subjectSpinnerAdapter );        IntentFilter intentFilterSubject = new IntentFilter( "subjectList" );        requireActivity().registerReceiver( boBroadcastReceiverAllSubject, intentFilterSubject );        btnBottomSheetAddTeacherSave.setOnClickListener( new View.OnClickListener() {            @Override            public void onClick(View view) {                String name = edtBottomSheetAddTeacherName.getText().toString().trim();                String password = edtBottomSheetAddTeacherPassword.getText().toString().trim();                Subject subject = subjects.get( (int) spinnerBootomSheetAddTeacherSubjectName.getSelectedItemId() );                int subjectID = subject.getId();                if (name.equals( "" ) || password.equals( "" )) {                    Toast.makeText( getActivity(), "Please fill all record and agine", Toast.LENGTH_SHORT ).show();                    return;                }                progressDialog.setMessage( "Inserting..." );                progressDialog.show();                IntentFilter intentFilterStateInsertTeacher = new IntentFilter( "stateInsertTeacher" );                requireActivity().registerReceiver( broadcastReceiverStateInsertTeacher, intentFilterStateInsertTeacher );                teacherQuery.callTaskInsertTeacher( new Teacher( 0, name, password, subjectID ) );            }        } );        return view;    }    //for get All Subject    BroadcastReceiver boBroadcastReceiverAllSubject = new BroadcastReceiver() {        @Override        public void onReceive(Context context, Intent intent) {            subjects = teacherQuery.getAllSubject();            subjectSpinnerAdapter.setData( subjects );        }    };    //for Insert Student    BroadcastReceiver broadcastReceiverStateInsertTeacher = new BroadcastReceiver() {        @Override        public void onReceive(Context context, Intent intent) {            Log.d( "stateInTe", teacherQuery.getStateInsertTeacher() + "" );            if (teacherQuery.getStateInsertTeacher()) {                progressDialog.hide();                dismiss();            } else {                Toast.makeText( getActivity(), "Faild", Toast.LENGTH_SHORT ).show();            }        }    };}